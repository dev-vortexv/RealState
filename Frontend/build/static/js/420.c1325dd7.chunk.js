"use strict";(self.webpackChunkQueenevaagentai=self.webpackChunkQueenevaagentai||[]).push([[420],{13420:function(e,a,t){t.r(a),t.d(a,{default:function(){return L}});var l=t(97890),i=t(77276),r=t(85833),s=t(98616),n=t(67662),o=t(47313),d=t(41806),c=t(47825),h=t(42832),m=t(61113),x=t(31095),u=t(73428),p=t(10237),g=t(17592),j=t(17551),v=t(85582),Z=t(51405),f=t(66149),b=t(9019),C=t(1550),y=t(5178),w=t(55685),D=t(74268),S=t(88797),T=t(24631),N=t(4117),k=t(96467),E=t(97762),I=t(33604),_=t(23195),A=t(83929),P=t(79429),M=(t(3463),t(31387)),R=t(35460),z=t(6210),W=t(78830),B=t(46417);var F=e=>{const{open:a,handleClose:t}=e,[l,i]=(0,o.useState)([]),[r,s]=(0,o.useState)([]),n=JSON.parse(localStorage.getItem("user"));(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,z.ac)("admin"===n.role?"api/contact/viewallcontacts":`api/contact/viewusercontacts/${n._id}`);"admin"===n.role?i(e.data.contactDetails):i(e.data)}catch(e){console.log(e)}})(),(async()=>{try{const e=await(0,z.ac)("admin"===n.role?"api/lead/viewallleads":`api/lead/viewuserleads/${n._id}`);s(null===e||void 0===e?void 0:e.data)}catch(e){console.log(e)}})()}),[]);const d=(0,P.TA)({initialValues:{recipient:"default",subject:"",startDate:"",endDate:"",message:"",category:"lead"},validationSchema:W.Io,onSubmit:async(e,a)=>{let{resetForm:l}=a;console.log(e),(async(e,a)=>{e.sender=JSON.parse(localStorage.getItem("user"))._id;try{"contact"===e.category?e.createBy=e.recipient:e.createByLead=e.recipient,200===(await(0,z.Fv)("api/email/add",e)).status?(M.Am.success("Email Added successfully"),t(),a()):(M.Am.error("Cannot Add Email"),a())}catch(l){M.Am.error("Cannot Add Email"),a()}})(e,l)}});return(0,B.jsx)("div",{children:(0,B.jsxs)(f.Z,{open:a,onClose:t,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",children:[(0,B.jsxs)(I.Z,{id:"scroll-dialog-title",style:{display:"flex",justifyContent:"space-between"},children:[(0,B.jsx)(m.Z,{variant:"h6",children:"Create Email"}),(0,B.jsx)(m.Z,{children:(0,B.jsx)(_.Z,{onClick:t,style:{cursor:"pointer"}})})]}),(0,B.jsx)(k.Z,{dividers:!0,sx:{width:"100%",minWidth:"600px"},children:(0,B.jsx)("form",{children:(0,B.jsxs)(E.Z,{id:"scroll-dialog-description",tabIndex:-1,children:[(0,B.jsx)(b.ZP,{item:!0,xs:12,sm:12,md:6,children:(0,B.jsxs)(C.Z,{fullWidth:!0,children:[(0,B.jsx)(y.Z,{sx:{marginTop:"2px"},children:"Related To"}),(0,B.jsxs)(w.Z,{row:!0,"aria-label":"category",name:"category",value:d.values.category,onChange:d.handleChange,children:[(0,B.jsx)(A.Z,{value:"contact",control:(0,B.jsx)(D.Z,{}),label:"Contact"}),(0,B.jsx)(A.Z,{value:"lead",control:(0,B.jsx)(D.Z,{}),label:"Lead"})]})]})}),(0,B.jsx)(b.ZP,{item:!0,xs:12,sm:12,md:12,sx:{marginTop:"3px"},children:(0,B.jsxs)(C.Z,{fullWidth:!0,children:[(0,B.jsx)(y.Z,{children:"contact"===d.values.category?"Recipient ( contact )":"Recipient ( lead )"}),(0,B.jsx)(S.Z,{id:"recipient",name:"recipient",label:"",size:"small",fullWidth:!0,value:d.values.recipient,onChange:d.handleChange,error:d.touched.recipient&&Boolean(d.errors.recipient),children:"contact"===d.values.category?[(0,B.jsx)(Z.Z,{value:"default",disabled:!0,children:"Assignment To"},"default"),...l.map((e=>(0,B.jsx)(Z.Z,{value:e._id,children:e.email},e._id)))]:[(0,B.jsx)(Z.Z,{value:"default",disabled:!0,children:"Assignment To"},"default"),...r.map((e=>(0,B.jsx)(Z.Z,{value:e._id,children:e.leadEmail},e._id)))]})]})}),(0,B.jsxs)(b.ZP,{item:!0,xs:12,sm:4,md:4,sx:{marginTop:"3px"},children:[(0,B.jsx)(y.Z,{children:"Start Date"}),(0,B.jsx)(T.Z,{id:"startDate",name:"startDate",label:"",type:"date",size:"small",fullWidth:!0,InputLabelProps:{shrink:!0},value:d.values.startDate,onChange:d.handleChange,error:d.touched.startDate&&Boolean(d.errors.startDate),helperText:d.touched.startDate&&d.errors.startDate})]}),(0,B.jsxs)(b.ZP,{item:!0,xs:12,sm:4,md:4,sx:{marginTop:"3px"},children:[(0,B.jsx)(y.Z,{children:"End Date"}),(0,B.jsx)(T.Z,{id:"endDate",name:"endDate",label:"",type:"date",size:"small",fullWidth:!0,InputLabelProps:{shrink:!0},value:d.values.endDate,onChange:d.handleChange,error:d.touched.endDate&&Boolean(d.errors.endDate),helperText:d.touched.endDate&&d.errors.endDate})]}),(0,B.jsxs)(b.ZP,{item:!0,xs:12,sm:12,md:12,sx:{marginTop:"3px"},children:[(0,B.jsx)(y.Z,{children:"Subject"}),(0,B.jsx)(T.Z,{id:"subject",name:"subject",label:"",size:"small",fullWidth:!0,placeholder:"Enter subject",value:d.values.subject,onChange:d.handleChange,error:d.touched.subject&&Boolean(d.errors.subject),helperText:d.touched.subject&&d.errors.subject})]}),(0,B.jsxs)(b.ZP,{item:!0,xs:12,sm:12,md:12,sx:{marginTop:"3px"},children:[(0,B.jsx)(y.Z,{children:"Message"}),(0,B.jsx)(T.Z,{id:"message",name:"message",label:"",size:"small",multiline:!0,rows:5,fullWidth:!0,placeholder:"Enter Message",value:d.values.message,onChange:d.handleChange,error:d.touched.message&&Boolean(d.errors.message),helperText:d.touched.message&&d.errors.message})]})]})})}),(0,B.jsx)(N.Z,{children:(0,B.jsx)(x.Z,{onClick:d.handleSubmit,variant:"contained",style:{backgroundColor:R.Z.info,color:"#fff"},children:"Add Email"})})]})})},O=t(70816),$=t.n(O);(0,g.ZP)((e=>(0,B.jsx)(v.Z,{elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},...e})))((e=>{let{theme:a}=e;return{"& .MuiPaper-root":{borderRadius:6,marginTop:a.spacing(1),minWidth:180,color:"light"===a.palette.mode?"rgb(55, 65, 81)":a.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:a.palette.text.secondary,marginRight:a.spacing(1.5)},"&:active":{backgroundColor:(0,j.Fq)(a.palette.primary.main,a.palette.action.selectedOpacity)}}}}}));var L=()=>{const[e,a]=(0,o.useState)(!1),[t,g]=(0,o.useState)([]),[j,v]=(0,o.useState)(""),[f,b]=o.useState(null),C=(0,l.s0)(),y=JSON.parse(localStorage.getItem("user"));(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,z.ac)("admin"===y.role?"api/email/viewallemails":`api/email/viewuseremails/${y._id}`);g(null===e||void 0===e?void 0:e.data)}catch(e){console.log(e)}})()}),[e]);let w=0;const D=[{field:"id",headerName:"#",flex:1,renderCell:()=>(0,B.jsxs)(d.Z,{children:[" ",w+=1]})},{field:"senderName",headerName:"Sender Name",flex:1},{field:"recipientName",headerName:"Recipient",flex:1,cellClassName:"name-column--cell name-column--cell--capitalize",renderCell:e=>(0,B.jsx)(d.Z,{onClick:()=>{C(`/email/view/${e.row._id}`)},children:e.value})},{field:"category",headerName:"Realeted To",flex:1},{field:"timestamp",headerName:"Timestamp",flex:1,renderCell:e=>(0,B.jsx)(d.Z,{children:$()(e.row.timestamp).fromNow()})},{field:"startDate",headerName:"Created",flex:1,renderCell:e=>(0,B.jsxs)(d.Z,{children:[" ",$()(e.row.startDate.startDate).format("(MM/DD) hh:mma")]})},{field:"action",headerName:"Action",flex:1,renderCell:e=>(0,B.jsx)(B.Fragment,{children:(0,B.jsxs)(Z.Z,{onClick:()=>{return a=e.row._id,void C(`/email/view/${a}`);var a},disableRipple:!0,children:[(0,B.jsx)(p.Z,{style:{marginRight:"8px",color:"green"}}),"View"]})})}];return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(F,{open:e,handleClose:()=>a(!1)}),(0,B.jsxs)(c.Z,{children:[(0,B.jsxs)(h.Z,{direction:"row",alignItems:"center",mb:5,justifyContent:"space-between",children:[(0,B.jsx)(m.Z,{variant:"h4",children:"Emails"}),(0,B.jsx)(h.Z,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:2,children:(0,B.jsx)(x.Z,{variant:"contained",startIcon:(0,B.jsx)(s.Z,{icon:"eva:plus-fill"}),onClick:()=>a(!0),children:"New Email"})})]}),(0,B.jsx)(n.Z,{children:(0,B.jsx)(d.Z,{width:"100%",children:(0,B.jsxs)(u.Z,{style:{height:"600px",paddingTop:"15px"},children:[(0,B.jsxs)(m.Z,{variant:"h4",sx:{margin:"2px 15px"},children:["Emails ( ",null===t||void 0===t?void 0:t.length," )"]}),(0,B.jsx)(i._$,{rows:t||[],columns:D,checkboxSelection:!0,getRowId:e=>e._id,slots:{toolbar:r.n},slotProps:{toolbar:{showQuickFilter:!0}}})]})})})]})]})}}}]);